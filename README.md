# java-filmorate

# Модель базы данных (ER-diagram)

![My First Board (3)](https://github.com/user-attachments/assets/50463511-131e-433a-9a3d-1269d79d34b9)


## Таблицы и поля

### users  
Таблица cодержит данные о пользователях:  
- **user_id** (первичный ключ) — идентификатор пользователя  
- **name** — имя пользователя
- **login** — логин пользователя 
- **email** — электронная почта пользователя  
- **birthday** — дата рождения пользователя  

### films  
Таблица содержит данные о фильмах:  
- **film_id** (первичный ключ) — идентификатор фильма  
- **name** — наименование фильма  
- **description** — описание фильма  
- **release_date** — дата релиза фильма  
- **duration** — продолжительность фильма  
- **rating_id** (внешний ключ) — идентификатор рейтинга Ассоциации кинокомпаний (МРА)  

### friendship  
Таблица содержит данные о друзьях:  
- **request_friend_id** (составной первичный ключ, внешний ключ к users) — идентификатор пользователя, который отправил запрос на добавление в друзья  
- **response_friend_id** (составной первичный ключ, внешний ключ к users) — идентификатор пользователя, которому отправлен запрос  

### likes  
Таблица содержит данные о пользователях и фильмах, которые они лайкнули:  
- **film_id** (составной первичный ключ, внешний ключ к films) — идентификатор фильма  
- **user_id** (составной первичный ключ, внешний ключ к users) — идентификатор пользователя  


### genre  
Таблица содержит данные о жанрах фильмов: 
- **genre_id** (первичный ключ) — идентификатор жанра  
- **name_genre** — наименование жанра  


### film_genre  
Таблица содержит данные о фильмах и жанрах, которые могут быть у них:
- **film_id** (составной первичный ключ, внешний ключ к films) — идентификатор фильма  
- **genre_id** (составной первичный ключ, внешний ключ к genre) — идентификатор жанра  

### mpa 
Таблица содержит данные о рейтинге Ассоциации кинокомпаний (МРА):  
- **rating_id** (первичный ключ) — идентификатор рейтинга  
- **name_rating** — наименование рейтинга  

---

## Примеры SQL-запросов

```sql
-- Получение всех пользователей
SELECT *
FROM users;

-- Список общих друзей с другим пользователем
SELECT fs.response_friend_id
FROM friendship AS fs
WHERE fs.request_friend_id = 1
  AND fs.response_friend_id IN
    (SELECT response_friend_id
     FROM friendship
     WHERE request_friend_id = 3);

-- Получение всех фильмов
SELECT *
FROM films;

-- Топ 5 наиболее популярных фильмов
SELECT f.film_id,
       f.name,
       COUNT(l.like_id) AS count_likes
FROM films AS f
LEFT OUTER JOIN likes AS l ON f.film_id = l.film_id
GROUP BY f.film_id
ORDER BY count_likes DESC
LIMIT 5;
```
